<%- include('partials/init-doc.ejs', {tituloPagina: 'Perfil Mascota'}) %> 

<body>
    <div class="container-xxl bg-white p-0">
        <!-- Spinner Start -->
        <%- include('partials/spinner.ejs') %> 
        <!-- Spinner End -->

        <!-- Header Start -->
        <%- include('partials/main-header.ejs', {active: 2}) %> 
        <!-- Header End -->

        <div class="row">
            <div class="col-lg-3">
                <div class="col-lg-12 col-md-6 wow fadeInUp" data-wow-delay="0.1s">
                    <div class="rounded shadow overflow-hidden">
                        <div class="position-relative">
                            <img class="img-fluid" src="img/mascotas.png" alt="">
                            <div class="position-absolute start-50 top-100 translate-middle d-flex align-items-center">
                            </div>
                        </div>
                        <div class="text-center p-4 mt-3">
                            <h5 class="fw-bold mb-0 text-info" style="cursor: pointer;" onclick="editarNombre('<%= mascota[0].nombre %>', '<%= mascota[0].id %>')"><u><%= mascota[0].nombre %></u></h5>
                            <h6><%= mascota[0].especie %></h6>
                            <h6><%= mascota[0].tipo %></h6>
                        </div>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-title">
                            <h4>Consultas</h4>
                        </div>
                        <div class="card-body">
                            <ul class="timeline">
                                <% consultasproximas.forEach((consulta)=>{%> 
                                    <li>
                                        <div class="timeline-badge primary"><%= consulta.dia.toLocaleDateString('en-GB') %> - <%= consulta.hora %></div>
                                        <div class="timeline-panel">
                                            <div class="timeline-heading">
                                                <h5 class="timeline-title"><%= consulta.mascota %></h5>
                                            </div>
                                            <div class="timeline-body">
                                                <p><%= consulta.veterinario_nombre %> <%= consulta.veterinario_apellido %> - <%= consulta.clinica %></p>
                                            </div>
                                        </div>
                                    </li>
                                    <%}) %>
                            </ul>
                        </div>
                    </div>
                    <!-- /# card -->
                </div>
            </div>
            <div class="col-lg-9">
                <div class="card">
                    <div class="card-title">
                        <h4>Veterinarios</h4>
                    </div>
                    <div class="bootstrap-data-table-panel">
                        <div class="table-responsive">
                            <table id="row-select2" class="display table table-borderd table-hover">
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Cedula</th>
                                        <th>Telefono</th>
                                        <th>Correo</th>
                                        <th>Clinica</th>
                                        <th>Opciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% veterinarios.forEach((veterinario)=>{%> 
                                        <tr>
                                            <td><%= veterinario.veterinario_nombre %> <%= veterinario.veterinario_apellido %></td>
                                            <td><%= veterinario.cedula_veterinario %></td>
                                            <td><%= veterinario.veterinario_celular %></td>
                                            <td><%= veterinario.veterinario_correo %></td>
                                            <td><%= veterinario.clinica %></td>
                                            <td>
                                                <div class="button-list">
                                                    <div class="btn-group btn-group-justified">
                                                        <a href="/agendarcita?usuario=<%= usuario.id %>&clinica=<%= veterinario.id_clinica %>&veterinario=<%= veterinario.id_veterinario %>" class="btn btn-warning btn-sm" target="_self" title="Agendar una Cita"><i class="fa fa-calendar"></i></a>
                                                        <a href="/addcomment?veterinario=<%= veterinario.id_veterinario %>" class="btn btn-info btn-sm" target="_self" title="Dejar Comentario"><i class="fa fa-comment"></i></a>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    <%}) %>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Cedula</th>
                                        <th>Telefono</th>
                                        <th>Correo</th>
                                        <th>Clinica</th>
                                        <th>Opciones</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Footer Start -->
        <div class="copyright">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="border-bottom" href="#">PetCare</a>, Todos los derechos reservados. 
					<!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
					Designed By <a class="border-bottom" href="https://htmlcodex.com">HTML Codex</a>
                    <br>Distributed By: <a class="border-bottom" href="https://themewagon.com" target="_blank">ThemeWagon</a>
                </div>
            </div>
        </div>
        <!-- Footer End -->

        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <script>
        function editarNombre(actualNombre, folio){
            Swal.fire({
                title: 'CAMBIAR NOMBRE DE TU AMIGO',
                text: 'Ingrese el nuevo nombre',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Actualizar',
                html: 
                    `<input type="text" value="${actualNombre}" id="nombre" class="swal2-input">`,
                focusConfirm: false
            }).then((result)=>{
                if(result.isConfirmed){
                    const nombre = document.getElementById('nombre').value;
                    const ruta = `/actualizarNombreMascota?id=${folio}&nombre=${nombre}`
                    window.location = ruta
                }
            })
        }
    </script>

    <%- include('partials/linksjs.ejs') %> 
    <%- include('partials/cierrebody.ejs') %> 